---
launch:
  - arg: {name: verbosity, default: '0'}
  - set_remap: {from: hydra/input/frontleft/depth_registered/image_rect, to: /spot/depth/frontleft/depth_in_visual}
  - set_remap: {from: hydra/input/frontleft/rgb/image_raw, to: /spot/camera/frontleft/image}
  - set_remap: {from: hydra/input/frontleft/rgb/camera_info, to: /spot/camera/frontleft/camera_info}
  - set_remap: {from: hydra/input/frontleft/semantic/image_raw, to: /spot/frontleft/segmentation/semantics/image_raw}
  - set_remap: {from: /spot/frontleft/segmentation/color/image_raw, to: /spot/camera/frontleft/image}
  - arg: {name: model_name, default: ade20k-efficientvit_seg_l2}
  - arg: {name: labelspace_name, default: ade20k_mit, description: Label remapping configuration}
  - node:
      pkg: semantic_inference_ros
      exec: closed_set_node
      name: spot/frontleft/segmentation
      args: >
        --config-utilities-file $(find-pkg-share semantic_inference_ros)/config/models/$(var model_name).yaml
        --config-utilities-file $(find-pkg-share semantic_inference_ros)/config/label_groupings/$(var labelspace_name).yaml@output/recolor
        --config-utilities-yaml {segmenter: {model: {model_file: $(var model_name).onnx}}}
        --config-utilities-yaml {output: {recolor: {colormap_path: $(var colormap_path)}}}
        --config-utilities-yaml {worker: {max_queue_size: 1, image_separation_s: 0.0}}
        --config-utilities-yaml {image_rotator: {rotation: none}}
  - node:
      pkg: hydra_ros
      exec: hydra_ros_node
      name: hydra
      env:
        - {name: TERM, value: xterm-256color}
      param:
        - {name: use_sim_time, value: true}
      args: >
        --config-utilities-file $(find-pkg-share hydra)/config/datasets/uhumans2.yaml
        --config-utilities-file $(find-pkg-share hydra_ros)/config/datasets/uhumans2.yaml
        --config-utilities-file $(find-pkg-share hydra)/config/label_spaces/uhumans2_office_label_space.yaml
        --config-utilities-yaml {glog_level: 0, verbosity: $(var verbosity)}
        --config-utilities-yaml {robot_id: 0, odom_frame: world, robot_frame: base_link_gt, map_frame: map}
        --config-utilities-yaml {semantic_label_remap_filepath: $(find-pkg-share hydra)/config/label_remaps/uhumans2_office.yaml}
