---
_definitions:
  - exec: &exec
      type: launch
      contents:
        launch:
          - arg: {name: bag_path}
          - arg: {name: trajectory}
          - arg: {name: robot_name}
          - arg: {name: output_path}
          - arg: {name: labelspace_name, default: ade20k_mit}
          - push_ros_namespace: {namespace: $(var robot_name)}
          - node:
              pkg: semantic_inference_ros
              exec: closed_set_node
              namespace: forward
              name: segmentation
              args: >
                --config-utilities-file $(find-pkg-share semantic_inference_ros)/config/models/ade20k-efficientvit_seg_l2.yaml
                --config-utilities-file $(find-pkg-share semantic_inference_ros)/config/label_groupings/$(var labelspace_name).yaml@output/recolor
                --config-utilities-yaml {output: {recolor: {colormap_path: $(find-pkg-share semantic_inference_ros)/config/distinct_150_colors.csv}}}
                --config-utilities-yaml {segmenter: {model: {model_file: ade20k-efficientvit_seg_l2.onnx}}}
                --config-utilities-yaml {worker: {max_queue_size: 1, image_separation_s: 0.0}}
          - node:
              pkg: hydra_ros
              exec: hydra_ros_node
              name: hydra
              param:
                - {name: use_sim_time, value: true}
              remap:
                - {from: hydra/input/forward/depth_registered/image_rect, to: forward/depth/image_rect}
                - {from: hydra/input/forward/rgb/image_raw, to: forward/color/image_raw}
                - {from: hydra/input/forward/rgb/camera_info, to: forward/color/camera_info}
                - {from: hydra/input/forward/semantic/image_raw, to: forward/semantic/image_raw}
              args: >
                --config-utilities-file $(find-pkg-share dcist_launch_system)/config/bag_kimera_multi/kimera_multi_hydra.yaml
                --config-utilities-file $(find-pkg-share hydra)/config/label_spaces/$(var labelspace_name)_label_space.yaml
                ---config-utilities-yaml {odom_frame: $(var robot_name)/odom, robot_frame: $(var robot_name)/body}
                --config-utilities-yaml {glog_level: 0, glog_verbosity: 1}
                --config-utilities-yaml {log_path: $(var output_path)/hydra}
          - node: {pkg: ianvs, exec: play_rosbag, args: --clock $(var bag_path)}
name: kimera_multi_gt
trials:
  - name: 10_14_acl_jackal
    executable: *exec
    args:
      bag_path: $(env KIMERA_MULTI_PATH)/outdoor_10_14/10_14_acl_jackal.bag
      trajectory: $(env KIMERA_MULTI_PATH)/outdoor_10_14/acl_jackal_gt_odom.csv
      robot_name: acl_jackal
